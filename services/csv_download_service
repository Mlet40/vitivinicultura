class CSVDownloadService:
    def __init__(self, base_url, download_dir='./csv'):
        self.base_url = base_url
        self.download_dir = download_dir
        # Verifica se o diretório de download existe, se não, cria o diretório
        if not os.path.exists(self.download_dir):
            os.makedirs(self.download_dir)

    def download_csv(self, filename):
        url = f"{self.base_url}/{filename}"
        try:
            response = requests.get(url)
            response.raise_for_status()  # Lança uma exceção para códigos de status HTTP 4xx/5xx
            file_path = os.path.join(self.download_dir, filename)
            with open(file_path, 'wb') as file:
                file.write(response.content)
            return True
        except requests.exceptions.RequestException as e:
            print(f"Erro ao baixar o arquivo {filename}: {e}")
            return False
